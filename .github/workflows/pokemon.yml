on:
  push:
  workflow_dispatch:         
jobs:
  event-handler:
    runs-on: windows-latest  
    env:
        token: ${{ secrets.SECRET_TOKEN }}
    steps:  
      - name: Getting Github Credentials
        run: |
          git config user.email "carldomond7@gmail.com"
          git config user.name "carldomond7"
      - name: Checkout code
        uses: actions/checkout@v2
      - name: Run Powershell Script
        run: |
          $apiURL = "https://pokeapi.co/api/v2/pokemon-species/infernape"
          $infernape_info = Invoke-RestMethod -Uri $apiURL -Method Get 
          $uniqueFilename = "infernape.txt" + (Get-Date -Format "yyyyMMddHHmmss") 
          $infernape_info | Set-Content -Path $uniqueFilename
          git add $uniqueFilename
          git config user.email "carldomond7@gmail.com"
          git config user.name "carldomond7"
          git commit -m "New Infernape has Appeared"
          git push origin main
        shell: pwsh
          
